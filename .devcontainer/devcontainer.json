// For format details, see https://aka.ms/devcontainer.json.
{
  "name": "C++",
  "build": {
    "dockerfile": "Dockerfile"
  },

  "features": {
    "ghcr.io/devcontainers/features/git-lfs:1": {},
    "ghcr.io/devcontainers/features/node:1": {},
    "ghcr.io/shyim/devcontainers-features/bun": {},
    "ghcr.io/devcontainers-extra/features/actions-runner": {},
    "ghcr.io/dhoeric/features/act": {},
    "ghcr.io/devcontainers/features/docker-in-docker": {}
  },

  // Mount host Git credentials & SSH keys
  "mounts": [
    "type=bind,source=${env:HOME}/.ssh,target=/home/vscode/.ssh"
  ],

  // Fix SSH key permissions (otherwise GitHub SSH will fail)
  "postCreateCommand": "chmod 600 ~/.ssh/id_rsa 2>/dev/null || true",

  // Run container as normal VS Code user
  "remoteUser": "vscode"
}
